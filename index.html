<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notificador de Quadras de Pickleball</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Barra de utilizador -->
    <div class="user-bar">
        <div class="user-info">
            <span id="user-display" onclick="showUserSettingsModal()">Visitante</span>
            <span id="user-points" class="points">0 pts</span>
        </div>
        <div class="user-actions">
            <button id="login-btn" onclick="showLoginModal()">Login</button>
            <button id="register-btn" onclick="showRegisterModal()">Cadastre-se</button>
            <button id="logout-btn" onclick="logout()" style="display: none;">Logout</button>
            <button id="ranking-btn" onclick="showRankingModal()">üèÜ Ranking</button>
            <!-- NOVO: Bot√£o para o painel de administra√ß√£o -->
            <button id="admin-panel-btn" onclick="showAdminPanelModal()" style="display: none;">‚öôÔ∏è Admin</button>
        </div>
    </div>

    <div class="container">
        <h1>üèì Notificador de Quadras de Pickleball</h1>
        <div class="court-status">
            <div class="court-card">
                <h2>Quadra CERET</h2>
                <!-- NOVO: Elemento para o aviso de aula na quadra CERET -->
                <div id="announcement-ceret" class="court-announcement left"></div>
                <p id="status-ceret" class="free">
                    <span class="status-indicator free"></span>
                    Livre
                </p>
                <button id="btn-ceret" onclick="toggleCourtStatus('ceret')">Ocupar Quadra</button>
                <div id="timer-ceret" class="timer" style="display: none;"></div>
                <div id="players-ceret" class="players-list"></div>
            </div>
            <div class="court-card">
                <h2>Quadra Pelez√£o</h2>
                <!-- NOVO: Elemento para o aviso de aula na quadra Pelez√£o -->
                <div id="announcement-pelezao" class="court-announcement right"></div>
                <p id="status-pelezao" class="free">
                    <span class="status-indicator free"></span>
                    Livre
                </p>
                <button id="btn-pelezao" onclick="toggleCourtStatus('pelezao')">Ocupar Quadra</button>
                <div id="timer-pelezao" class="timer" style="display: none;"></div>
                <div id="players-pelezao" class="players-list"></div>
            </div>
        </div>

        <!-- Se√ß√£o de Eventos -->
        <div class="events-section">
            <h2>üìÖ Eventos e Novidades</h2>
            <div id="events-container" class="events-container">
                <!-- Eventos ser√£o carregados dinamicamente aqui -->
                <div class="no-events-message">
                    <p>Nenhum evento programado no momento.</p>
                    <p>Fique atento √†s novidades!</p>
                </div>
            </div>
        </div>
    </div>

        <!-- Modal de Login -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideLoginModal()">&times;</span>
            <h2>üèì Login</h2>
            <form id="login-form" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label for="login-email">Email:</label>
                    <input type="email" id="login-email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="login-password">Senha:</label>
                    <input type="password" id="login-password" name="password" required>
                </div>
                <!-- NOVO: Link "Esqueci a senha?" -->
                <p class="login-note" style="text-align: right; margin-top: -10px; margin-bottom: 15px;">
                    <a href="#" onclick="showForgotPasswordModal()">Esqueci a senha?</a>
                </p>
                <button type="submit">Entrar</button>
            </form>
            <p class="login-note">Primeira vez? <a href="#" onclick="switchToRegister()">Cadastre-se aqui!</a></p>
        </div>
    </div>

        <!-- NOVO: Modal de Esqueci a Senha -->
    <div id="forgot-password-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideForgotPasswordModal()">&times;</span>
            <h2>üîí Redefinir Senha</h2>
            <form id="forgot-password-form" onsubmit="handleForgotPassword(event)">
                <p style="margin-bottom: 20px; text-align: center; color: #555;">
                    Informe o seu email cadastrado para receber um link de redefini√ß√£o de senha.
                </p>
                <div class="form-group">
                    <label for="forgot-password-email">Email:</label>
                    <input type="email" id="forgot-password-email" name="email" required>
                </div>
                <button type="submit">Enviar Link de Redefini√ß√£o</button>
            </form>
        </div>
    </div>


    <!-- Modal de Cadastro -->
    <div id="register-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideRegisterModal()">&times;</span>
            <h2>üìù Cadastre-se</h2>
            <form id="register-form" onsubmit="handleRegister(event)">
                <div class="form-group">
                    <label for="register-username">Nome:</label>
                    <input type="text" id="register-username" name="username" required>
                </div>
                <div class="form-group">
                    <label for="register-lastname">Sobrenome:</label>
                    <input type="text" id="register-lastname" name="lastname" required>
                </div>
                <div class="form-group">
                    <label for="register-email">Email:</label>
                    <input type="email" id="register-email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="register-password">Senha:</label>
                    <input type="password" id="register-password" name="password" required>
                </div>
                <div class="form-group">
                    <label for="register-confirm-password">Confirmar Senha:</label>
                    <input type="password" id="register-confirm-password" name="confirm-password" required>
                </div>
                <div class="form-group">
                    <label for="register-phone">Telefone (opcional):</label>
                    <input type="tel" id="register-phone" name="phone">
                </div>
                <button type="submit">Criar Conta</button>
            </form>
            <p class="login-note">J√° tem uma conta? <a href="#" onclick="switchToLogin()">Fa√ßa login aqui!</a></p>
        </div>
    </div>

    <!-- Modal de Ranking -->
    <div id="ranking-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideRankingModal()">&times;</span>
            <h2>üèÜ Ranking de Pontos</h2>
            <div id="ranking-list" class="ranking-list">
                <!-- Ranking ser√° preenchido dinamicamente -->
            </div>
        </div>
    </div>

    <!-- Modal de Configura√ß√µes do Utilizador -->
    <div id="user-settings-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideUserSettingsModal()">&times;</span>
            <h2>‚öôÔ∏è Minhas Configura√ß√µes</h2>
            <div class="user-details">
                <p><strong>Nome Completo:</strong> <span id="settings-full-name"></span></p>
                <p><strong>Email:</strong> <span id="settings-email"></span></p>
                <p><strong>Telefone:</strong> <span id="settings-phone"></span></p>
                <p><strong>Tempo Total na Quadra:</strong> <span id="settings-total-time"></span></p>
                <p><strong>Membro Desde:</strong> <span id="settings-join-date"></span></p>
            </div>
            <div class="time-history">
                <h3>Hist√≥rico de Tempo na Quadra:</h3>
                <ul id="history-list">
                    <!-- Hist√≥rico ser√° preenchido dinamicamente -->
                </ul>
            </div>
        </div>
    </div>

    <!-- NOVO: Modal do Painel de Administra√ß√£o -->
    <div id="admin-panel-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideAdminPanelModal()">&times;</span>
            <h2>‚öôÔ∏è Painel de Administra√ß√£o</h2>
            
            <div class="admin-section">
                <h3>Anunciar Aulas</h3>
                <form id="announcement-form" onsubmit="handleAnnouncement(event)">
                    <div class="form-group">
                        <label for="announcement-court">Quadra:</label>
                        <select id="announcement-court" required>
                            <option value="">Selecione a Quadra</option>
                            <option value="ceret">CERET</option>
                            <option value="pelezao">Pelez√£o</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="announcement-type">Tipo de An√∫ncio:</label>
                        <select id="announcement-type" onchange="toggleReasonField()" required>
                            <option value="class-on">Haver√° Aula</option>
                            <option value="class-off">N√£o Haver√° Aula</option>
                        </select>
                    </div>
                    <div class="form-group" id="announcement-reason-group" style="display: none;">
                        <label for="announcement-reason">Motivo (se n√£o houver aula):</label>
                        <textarea id="announcement-reason" rows="3" placeholder="Ex: Chuva, Manuten√ß√£o, Feriado..."></textarea>
                    </div>
                    <button type="submit">Publicar An√∫ncio</button>
                </form>
            </div>

            <div class="admin-section">
                <h3>Gerenciar Eventos</h3>
                <form id="event-form" onsubmit="handleEventSubmission(event)">
                    <div class="form-group">
                        <label for="event-title">T√≠tulo do Evento:</label>
                        <input type="text" id="event-title" required placeholder="Ex: Campeonato de Pickleball">
                    </div>
                    <div class="form-group">
                        <label for="event-type">Tipo de Evento:</label>
                        <select id="event-type" required>
                            <option value="">Selecione o Tipo</option>
                            <option value="campeonato">üèÜ Campeonato</option>
                            <option value="novidade">üì¢ Novidade</option>
                            <option value="passeio">üöå Passeio</option>
                            <option value="aula">üìö Aula Especial</option>
                            <option value="manutencao">üîß Manuten√ß√£o</option>
                            <option value="outro">üìÖ Outro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="event-date">Data do Evento:</label>
                        <input type="date" id="event-date" required>
                    </div>
                    <div class="form-group">
                        <label for="event-time">Hor√°rio:</label>
                        <input type="time" id="event-time" required>
                    </div>
                    <div class="form-group">
                        <label for="event-description">Descri√ß√£o:</label>
                        <textarea id="event-description" rows="4" required placeholder="Descreva os detalhes do evento..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="event-location">Local (opcional):</label>
                        <input type="text" id="event-location" placeholder="Ex: Quadra CERET, Sala de reuni√µes...">
                    </div>
                    <button type="submit">Criar Evento</button>
                </form>
            </div>

            <div class="admin-section">
                <h3>Eventos Existentes</h3>
                <div id="admin-events-list" class="admin-events-list">
                    <!-- Lista de eventos para administra√ß√£o ser√° carregada aqui -->
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Widget -->
    <div class="chat-widget collapsed" id="chat-widget">
        <div class="chat-header" onclick="toggleChat()">
            <h3 id="chat-header-text">üí¨ Chat</h3>
        </div>
        <div class="chat-body" id="chat-body">
            <div class="chat-messages" id="chat-messages">
                <!-- Mensagens do chat ser√£o carregadas aqui -->
            </div>
            <div class="chat-input">
                <input type="text" id="chat-message-input" placeholder="Digite sua mensagem...">
                <button id="chat-send-btn">Enviar</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="script.js"></script>
</body>
</html>
